<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	<meta name="description" content="童话说，一个关于Web前端的原创技术博客，不定期发布Web前端及其相关技术的博文">
	<meta name="keywords" content="tonghuashuo,github,前端,html,html5,css,css3,javascript,js,jquery,安卓,android,java,童话,童话说,华心童">
	<title>UserAgent - THS Lab</title>
	<link rel="stylesheet" type="text/css" href="../../css/lab.css">

</head>
<body>
	<h1>UserAgent</h1>
	<hr/>
	<p>Browser: <span id="browser"></span></p>
	<p>OS: <span id="os"></span></p>
	<br/>
	<p>UA: <span id="ua"></span></p>
	<p>Platform: <span id="platform"></span></p>
	<p id="error"></p>
	<hr/>
	<a href="../index.html" class="back">&laquo; Back</a>

	<script>
	window.onload = function() {
		if(navigator.userAgent) {
			var UA = window.navigator.userAgent;
			var ua = UA.toLowerCase();
			document.getElementById("ua").innerHTML = UA;

			var browser_span = document.getElementById("browser");
			var browser = "Unknown";
			var browserVersion = "";
			if (ua.indexOf("edge") > -1) {							// Edge / 12+
				browserVersion = ua.match(/edge\/\d+(.\d+)+/)[0].toString().substr(5);
				browser = "Microsoft Edge " + browserVersion;
			} else if (ua.indexOf("trident") > -1){					// IE 11
				browser = "IE 11";
			} else if (ua.indexOf("msie") > -1) {					// IE <10
				browserVersion = ua.match(/msie\s\d+/)[0].toString().substr(4);
				browser = "IE " + browserVersion;
			} else if (ua.indexOf("firefox") > -1){					// Firefox
				browserVersion = ua.match(/firefox\/\d+(.\d+)+/)[0].toString().substr(8);
				if(ua.indexOf("mobile"))
					browserVersion += " (mobile)";
				browser = "Firefox " + browserVersion;
			} else if (ua.indexOf("opera") > -1){					// Opera 9.8-
				browserVersion = ua.match(/opera\/\d+(.\d+)+/)[0].toString().substr(6);
				if(Number(browserVersion)>=9.8) {					// Opera 10+
					browserVersion = ua.match(/version\/\d+(.\d+)+/)[0].toString().substr(8);
				}
				if(ua.indexOf("mini") > -1) {						// Opera mini
					browserVersion = "mini " + ua.match(/mini\/\d+(.\d+)+/)[0].toString().substr(5);
				}
				browser = "Opera " + browserVersion;
			} else if (ua.indexOf("opr") > -1) {					// Opera with webkit/blink
				browserVersion = ua.match(/opr\/\d+.\d+.\d+.\d+/)[0].toString().substr(4);
				if (ua.indexOf("dev") > -1) {						// Opera dev edition
					browserVersion += " (edition developer)";
				} else if(ua.indexOf("beta") > -1) {				// Opera beta edition
					browserVersion += " (edition beta)";
				}
				if(ua.indexOf("mobile") > -1)
					browserVersion += " (mobile)";					// Opera Mobile
				browser = "Opera " + browserVersion;
			} else if (ua.indexOf("chrome") > -1){					// Chrome
				browserVersion = ua.match(/chrome\/\d+.\d+.\d+.\d+/)[0].toString().substr(7);
				if(ua.indexOf("mobile") > -1)
					browserVersion += " (mobile)";					// Chrome Mobile
				browser = "Chrome " + browserVersion;
			} else if (ua.indexOf("safari") > -1){					// Safari
				browserVersion = ua.match(/safari\/\d+(.\d+)+/)[0].toString().substr(7);
				browser = "Safari " + browserVersion;
			}

			// Unfinished Yet
			browser = otherBrowserCheck(browser);

			browser_span.innerHTML = browser;

		} else {
			document.getElementById("error").innerHTML = "userAgent not detected.";
		}

		if (navigator.platform) {
			var platform = window.navigator.platform;
			document.getElementById("platform").innerHTML = platform;
		}
		
		document.getElementById("os").innerHTML = detectOS();
	};

	function otherBrowserCheck(browser) {
		var ua = window.navigator.userAgent.toLowerCase();
		// UC

		// qqbrowser
		// ua = "Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MI 3C Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko)Version/4.0 Chrome/37.0.0.0 MQQBrowser/6.2 Mobile Safari/537.36".toLowerCase();
		if (ua.indexOf("mqqbrowser") > -1) {
			browserVersion = ua.match(/mqqbrowser\/\d+(.\d+)+/)[0].toString().substr(11);
			if(ua.indexOf("mobile") > -1) {
				browserVersion += "(mobile)";
			}
			webkitVersion = ua.match(/webkit\/\d+(.\d+)+/)[0].toString().substr(7);
			browser = "QQ Browser " + browserVersion + "/wekit " + webkitVersion;
		}

		// WeiXin
		if (ua.indexOf("micromessenger") > -1) {
			weixinVersion = ua.match(/micromessenger\/\d+(.\d+)+/)[0].toString().substr(15);
			webkitVersion = ua.match(/webkit\/\d+(.\d+)+/)[0].toString().substr(7);
			browser = "WeiXin " + weixinVersion + "/wekit " + webkitVersion;
		}
		
		// QQ
		// ua = "Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MI 3C Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025477 Mobile Safari/533.1 V1_AND_SQ_6.0.1_302_YYB_D QQ/6.0.1.2610 NetType/WIFI WebP/0.3.0 Pixel/1080".toLowerCase();
		if (ua.indexOf("qq/") > -1) {
			qqVersion = ua.match(/qq\/\d+(.\d+)+/)[0].toString().substr(3);
			webkitVersion = ua.match(/webkit\/\d+(.\d+)+/)[0].toString().substr(7);
			browser = "QQ " + qqVersion + "/wekit " + webkitVersion;
		}

		// sougou
		// 360
		// baidu
		// maxthon
		// liebao
		// Dolphin
		// Lunascape

		return browser;
	}

	function detectOS() {
		if (navigator.userAgent) {
		    var ua = navigator.userAgent.toLowerCase();
		    var os = "Unknown";

		    var isWin = navigator.platform == "Win32" || navigator.platform == "Windows";
		    var isMac = navigator.platform == "Mac68K"
		    		 || navigator.platform == "MacPPC" 
		    		 || navigator.platform == "Macintosh"
		    		 || navigator.platform == "MacIntel";
		    var isUnix = navigator.platform == "X11" && !isWin && !isMac;
		    var isLinux = navigator.platform.toLowerCase().indexOf("linux") > -1 || ua.indexOf("linux") > -1;

		    var isAndroid = ua.indexOf("android") > -1;
		    var isIPhone = ua.indexOf("iphone") > -1;;
		    var isIPad = ua.indexOf("ipad") > -1;
		    var isIOS = isIPhone || isIPad;
		    var isWinPhone = ua.indexOf("windows phone") > -1;
		    var isBlackbarry;
		    var isMeeGo = ua.indexOf("meego") > -1;

		    if (isMac)
		    	os = "Mac";
		    if (isUnix)
		    	os = "Unix";
		    if (isLinux && !isAndroid) {
		    	os = "Linux";
		    	if(ua.indexOf("kf")>-1) {
		    		os += "/Amazon Kindle";
		    	}
		    }
		    if (isWin) {
		        if (ua.indexOf("windows nt 5.0") > -1 || ua.indexOf("windows 2000") > -1)
		        	os = "Windows 2000";
		        if (ua.indexOf("windows nt 5.1") > -1 || ua.indexOf("windows xp") > -1)
		        	os = "Windows XP";
		        if (ua.indexOf("windows nt 5.2") > -1 || ua.indexOf("windows 2003") > -1)
		        	os = "Windows 2003";
		        if (ua.indexOf("windows nt 6.0") > -1 || ua.indexOf("windows Vista") > -1)
					os = "Windows Vista";
		        if (ua.indexOf("windows nt 6.1") > -1 || ua.indexOf("windows 7") > -1)
					os = "Windows 7";
				if (ua.indexOf("windows nt 6.2") > -1 || ua.indexOf("Windows 8") > -1)
					os = "Windows 8";
				if (ua.indexOf("windows nt 6.3") > -1 || ua.indexOf("windows 8.1") > -1)
					os = "Windows 8.1";
				if (ua.indexOf("windows nt 6.4") > -1 || ua.indexOf("windows nt 10.0") > -1 || ua.indexOf("windows 10") > -1)
					os = "Windows 10";
		    }
		    if (isAndroid) {
		    	var androidVersion = ua.substr(ua.indexOf("android")+8, 5);
		    	os = "Android " + androidVersion;
		    }
		    if (isIOS) {
		    	var iosVersion = "";
		    	if(isIPhone) {
		    		var reg = /\d(\_\d)+/;
		    		var str = ua.substr(ua.indexOf("cpu iphone os")+14, 5);
		    		iosVersion = reg.exec(str)[0].replace(/\_/g, '.');
		    		os = "iOS " + iosVersion + "/iPhone"
				} else if (isIPad) {
		    		var reg = /\d(\_\d)+/;
		    		var str = ua.substr(ua.indexOf("cpu os")+6, 5);
		    		iosVersion = reg.exec(str)[0].replace(/\_/g, '.');
		    		os = "iOS " + iosVersion + "/iPad"
		    	} else {
		    		os = "iOS";
		    	}
		    }

		    if (isWinPhone) {
		    	var reg = /\d(.\d)+/;
		    	var str = ua.substr(ua.indexOf("windows phone")+14, 5);
		    	var winPhoneVersion = reg.exec(str)[0];
		    	os = "Windows Phone " + winPhoneVersion;
		    }

		    if (isMeeGo) {
		    	os = "MeeGo";
		    }

		    return os;
		}
	    return "Unknown";
	}
	</script>
</body>
</html>